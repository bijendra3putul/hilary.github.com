{% capture date %}{{ page.date }}{{ post.date }}{% endcapture %}
{% capture date_formatted %}{{ page.date_formatted }}{{ post.date_formatted }}{% endcapture %}
{% capture has_date %}{{ date | size }}{% endcapture %}

{% capture updated %}{{ page.updated }}{{ post.updated }}{% endcapture %}
{% capture updated_formatted %}{{ page.updated_formatted }}{{ post.updated_formatted }}{% endcapture %}
{% capture was_updated %}{{ updated | size }}{% endcapture %}

{% if has_date %}
  {% if was_updated and was_updated > '0' %}
    <span class="pubdate">
      <time datetime="{{ date | datetime | date_to_xmlschema }}" pubdate data-updated="true">{{ date_formatted }}</time> 
      (last updated <time datetime="{{ updated | datetime | date_to_xmlschema }}" class="updated">{{ updated_formatted }}</time>)
    </span>
  {% else %}
    <span class="pubdate">
      <time datetime="{{ date | datetime | date_to_xmlschema }}" pubdate>{{ date_formatted }}</time>
    </span>
  {% endif %}
{% elsif was_updated and was_updated > '0' %}
  <span class="pubdate">
    last updated <time datetime="{{ updated | datetime | date_to_xmlschema }}" class="updated">{{ updated_formatted }}</time>
  </span>
{% endif %}
